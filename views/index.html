<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knit Architects Engine</title>
    <style>
        body { font-family: "Georgia", serif; background: #f2f2f7; margin: 0; display: flex; height: 100vh; }
        .sidebar { width: 300px; background: #e5e5ea; padding: 20px; overflow-y: auto; box-shadow: 2px 0 5px rgba(0,0,0,0.1); box-sizing: border-box; }
        .content { flex: 1; padding: 40px; overflow-y: auto; box-sizing: border-box; }
        .pattern-paper { background: #fff; max-width: 800px; margin: 0 auto; padding: 40px; box-shadow: 0 0 20px rgba(0,0,0,0.1); line-height: 1.6; color: #333; }
        
        /* Form Elements */
        h2 { font-size: 16px; background: #333; color: #fff; padding: 5px 10px; text-transform: uppercase; margin-top: 0; }
        label { font-weight: bold; font-size: 14px; color: #555; display: block; margin-top: 15px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; background: #007AFF; color: white; border: none; padding: 15px; font-size: 16px; font-weight: bold; border-radius: 6px; cursor: pointer; margin-top: 25px; }
        
        /* Responsive */
        @media (max-width: 800px) {
            body { flex-direction: column; height: auto; }
            .sidebar { width: 100%; height: auto; border-bottom: 2px solid #ccc; }
            .content { width: 100%; padding: 15px; }
            .pattern-paper { padding: 20px; width: 100%; }
        }

        /* Pattern Styling */
        h1 { font-size: 22px; border-bottom: 2px solid #333; padding-bottom: 10px; }
        .row-inst { margin-bottom: 10px; font-size: 15px; border-bottom: 1px dotted #eee; padding-bottom: 5px; }
        .sts-count { color: #007AFF; font-weight: bold; font-size: 14px; display: block; margin-top: 2px; }
        
        /* Abbreviations Section */
        .abbreviations { background: #f9f9f9; padding: 15px; border: 1px solid #ddd; margin-top: 30px; font-size: 0.9em; }
        .abbreviations h3 { margin-top: 0; font-size: 1em; text-transform: uppercase; color: #555; }
        .abbr-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 5px; }
        .abbr-item { color: #333; }
        .abbr-key { font-weight: bold; color: #000; }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>Parameters</h2>
        <div>
            <label>Chest (cm)</label>
            <input type="number" id="chest" value="99">
        </div>
        <div>
            <label>Gauge (Sts / 10cm)</label>
            <input type="number" id="gaugeSts" value="19">
        </div>
        <div>
            <label>Gauge (Rows / 10cm)</label>
            <input type="number" id="gaugeRows" value="26">
        </div>
        <button onclick="generate()">GENERATE PATTERN</button>
    </div>
    
    <div class="content" id="output">
        <div style="text-align:center; color:#888; margin-top:50px;">
            <p><strong>Ready to draft.</strong></p>
            <p>Adjust parameters above and click GENERATE.</p>
        </div>
    </div>

    <script>
        async function generate() {
            const btn = document.querySelector('button');
            btn.innerText = "CALCULATING...";
            
            const d = { 
                gaugeSts: document.getElementById('gaugeSts').value, 
                gaugeRows: document.getElementById('gaugeRows').value, 
                chest: document.getElementById('chest').value 
            };
            
            try {
                const res = await fetch('/calc', { method:'POST', body:new URLSearchParams(d) }).then(r=>r.json());
                document.getElementById('output').innerHTML = res.patternHtml;
                if(window.innerWidth < 800) {
                    document.getElementById('output').scrollIntoView({behavior: "smooth"});
                }
            } catch(e) {
                alert("Error generating pattern");
                console.error(e);
            }
            btn.innerText = "GENERATE PATTERN";
        }
    </script>
</body>
</html>
